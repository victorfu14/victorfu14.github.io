\documentclass{report}
\usepackage{amsmath,amssymb,amsthm,textcomp,gensymb,nccmath}
\usepackage{mathtools}
\renewcommand{\qedsymbol}{$\blacksquare$}

\setlength{\topmargin}{0.5in}
\usepackage[margin=4cm]{geometry}
\usepackage{enumerate}

\usepackage{setspace}
\onehalfspacing
\usepackage{parskip}
\setlength{\parskip}{0.5em}
\usepackage[T1]{fontenc}
\usepackage{palatino}

% useful characters/operators
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\matP}{\mathbb{P}}
\newcommand{\matE}{\mathbb{E}}
\newcommand{\matS}{\mathbb{S}}
\newcommand{\matH}{\mathbb{H}}
\newcommand{\matT}{\mathbb{T}}
\newcommand{\st}{\ s.t.\ }
\newcommand{\ie}{\ i.e.\ }
\newcommand{\eg}{\ e.g.\ }
\def \diam {\operatorname{diam}}
\def \Hom {\operatorname{Hom}}
\def \id {\operatorname{id}}
\def \tr {\operatorname{tr}}
\def \rk {\operatorname{rk}}
\def \sp {\operatorname{span}}
\def \dist {\operatorname{dist}}
\def \intr {\operatorname{int}}
\def \sgn {\operatorname{sgn}}
\def \im {\operatorname{Im}}
\def \re {\operatorname{Re}}
\def \curl {\operatorname{curl}}
\def \divg {\operatorname{div}}
\def \GL {\operatorname{GL}}
\def \Aut {\operatorname{Aut}}
\def \per {\operatorname{per}}
\def \LE {\operatorname{LE}}
\def \indeg {\operatorname{indeg}}
\def \outdeg {\operatorname{outdeg}}
\def \Par {\operatorname{Par}}
\def \Gr {\operatorname{Gr}}
\def \del {\operatorname{del}}
\def \add {\operatorname{add}}
\def \Gal {\operatorname{Gal}}
\def \Sym {\operatorname{Sym}}
\def \dist {\operatorname{dist}}
\newcommand{\pdr}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\df}{\mathrm{d}}
\newcommand{\idf}{\ \mathrm{d}}
\newcommand{\dr}[2]{\dfrac{\df #1}{\df #2}}
\newcommand{\inner}[2]{\left\langle #1, #2\right\rangle}
\newcommand{\qbin}[2]{\begin{bmatrix}{#1}\\ {#2}\end{bmatrix}_q}
\newcommand{\into}{\hookrightarrow}
\newcommand{\onto}{\twoheadrightarrow}
\newcommand{\from}{\leftarrow}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\abs}[1]{\left| #1 \right|}

% arrows and :=, =:
\makeatletter
\providecommand*{\twoheadrightarrowfill@}{%
  \arrowfill@\relbar\relbar\twoheadrightarrow
}
\providecommand*{\twoheadleftarrowfill@}{%
  \arrowfill@\twoheadleftarrow\relbar\relbar
}
\providecommand*{\xtwoheadrightarrow}[2][]{%
  \ext@arrow 0579\twoheadrightarrowfill@{#1}{#2}%
}
\providecommand*{\xtwoheadleftarrow}[2][]{%
  \ext@arrow 5097\twoheadleftarrowfill@{#1}{#2}%
}
\makeatother

\newcommand{\defeq}{\vcentcolon=}
\newcommand{\eqdef}{=\mathrel{\mathop:}}

% integral for measure theory
\newcommand{\lowerint}{\underline{\int_{\R^d}}}
\newcommand{\upperint}{\overline{\int_{\R^d}}}
\newcommand{\lint}[1]{\underline{\int_{\R^d}} #1 (x)dx}
\newcommand{\uint}[1]{\overline{\int_{\R^d}} #1 (x)dx}
\newcommand{\sint}[1]{\simp{\int_{\R^d} #1 (x)dx}}
\newcommand{\lesint}[1]{\int_{\R^d} #1 (x)dx}

% note taking
\newcommand{\fancyem}[1]{\underline{\textsc{#1}}}

% theorem style
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{proposition}{Proposition}[section]

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}

% pseudocode and algorithms
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{algorithmicx}
\counterwithin{algorithm}{section}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% for clearer reference
\usepackage{hyperref}
\newcommand{\corollaryautorefname}{Corollary}
\newcommand{\lemmaautorefname}{Lemma}
\newcommand{\definitionautorefname}{Definition}
\newcommand{\exampleautorefname}{Example}
\newcommand{\conjectureautorefname}{Conjecture}
\renewcommand{\subsectionautorefname}{Section}
\newcommand{\algorithmautorefname}{Algorithm}

% other styling
\usepackage{fancyvrb, fancyhdr}
\usepackage{tikz-cd}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing,calligraphy}
\PassOptionsToPackage{usenames, x11names}{xcolor}
\usepackage{tcolorbox}
\selectcolormodel{cmy}

\newcommand{\edge}{
    \begin{tikzcd}[cramped, sep=small, labels={font=\everymath\expandafter{\the\everymath\textstyle}}]
        u \arrow[r, "e", no head] & v
    \end{tikzcd}
}


\pagestyle{fancy}
\fancyhead[LO,L]{\leftmark}
\fancyhead[RO,R]{Yiwei Fu}
\fancyfoot[CO,C]{\thepage}
\renewcommand{\sectionmark}[1]{\markboth{#1}{#1}}

\numberwithin{equation}{section}

\newcommand{\fnl}{\parbox[t]{0\linewidth}{}}
\newcommand*\ttlmath[2]{\texorpdfstring{$\boldsymbol{#1}$}{#2}}

\usepackage{epigraph}

% \epigraphsize{\small}% Default
\setlength\epigraphwidth{8cm}
\setlength\epigraphrule{0pt}

\usepackage{etoolbox}

\makeatletter
\patchcmd{\epigraph}{\@epitext{#1}}{\itshape\@epitext{#1}}{}{}
\makeatother

% combinatorics special
\usepackage{pgfopts}
\usepackage{ytableau}



\begin{document}
\title{Notes for Math 669}
\author{Yiwei Fu, Instructor: Alexander Barvinok}
\date{WN 2023}
\maketitle


\tableofcontents
Office hours: 

\clearpage
\pagenumbering{arabic}


\chapter{Introduction to Lattices}
\section{Definition}
\begin{definition}
    A lattice $\Lambda \subset V$ has the following properties:
    \begin{enumerate}
        \item $\operatorname{span}(\Lambda) = V$.
        \item $\Lambda$ is an additive subgroup.
        \item $\Lambda$ is discrete: for any $r > 0$, let $B_r = \set{x \in \R^n, \norm{x} \leq r}$, $\Lambda \cap B_r$ is finite.
    \end{enumerate}
\end{definition}

\section{Lattice and Its Basis}
Last time: $L \in V$ is a subspace if $L = \operatorname{span} (L \cap \Lambda)$

\begin{theorem}
    If $L$ is a lattice subspace, $L \neq V$, then $\exists u \in L \setminus \Lambda$ such that $d(u, L) \leq d(x, L)$ for all $x \in L \setminus \Lambda$.
\end{theorem}

Say $L \in \operatorname{span}\left\{u_1, \ldots, u_m\right\}$ linearly independent vectors, $\Pi = \left\{\right\}$ There is $u \in \Lambda \setminus L$ such that $\dist(u, \Pi) \leq \dist(x, \Pi)$ for all $x \in \Lambda \setminus L$. 
\begin{proof}
    Take $\rho > 0$ large enough. Consider $\Pi_\rho = \left\{y, d(y, \Pi) \leq \rho\right\}$. It contains points from $\Lambda \setminus L$, choose the one in $\Pi_\rho \cap (\Lambda \setminus L)$ closet to $\Pi$.
\end{proof}
\fancyem{Claim} $u \in \Lambda \setminus L$ is what we need. Why?
Pick any $x \in \Lambda \setminus L$. Let $y \in L$ be the closest to $x$. 
\[\dist(x, L) = \norm{x - y} = \norm{(x - w) - (y - w)}.\]
\[y = \sum_{i=1}^m d_iu_i\]
Let $w = \sum_{i=1}^m \floor{\alpha_i}u_i \in \Lambda \setminus L, y - w = \sum_{i=1}^m \set{\alpha_i}u_i \in \Pi$. 

\begin{theorem}
    Every lattice has a basis.
\end{theorem}
\begin{proof}
    By induction on $n = \dim V$.
    
    \textbf{Base case:} for $n = 1$, we have $V = \R$.

    Let $u > 0$ be the lattice vector closet to $0$, among all positive vectors in $\Lambda$.

    Then $u$ is a basis of $\Lambda$. Pick any $v \in \Lambda$. Assume $v > 0$ WLOG. Then $v = \alpha u$ for $\alpha > 0$. If $\alpha \in \Z$ then we are done. If not, consider $w = \alpha u - \floor{\alpha} u = \set{\alpha} u$, this is closer to $0$ than $u$, a contradiction.

    \textbf{Induction hypothesis:} suppose any lattice of dimension $n - 1$ has a basis.

    \textbf{Induction step:} pick a lattice hyperplane $H$ (lattice subspace with $\dim = n - 1$). Then $\Lambda_1 = H \cap \Lambda$ has a basis $u_1, \ldots, u_{n-1}$. Pick $u_n$ such that $u_n \notin H$ and $\dist(u_n, H)$ is the smallest. We claim that $u_1, \ldots, u_{n-1}, u_n$ is a basis of $\Lambda$.

    Let $u \in \Lambda$, $u = \sum_{i=1}^n \alpha_i u_i$ with $\alpha_i \in \R$. If $\alpha_n = 0$ then $u \in \Lambda_1$, then $\alpha_1, \ldots, \alpha_{n-1} \in \Z$. Suppose $\alpha_n \neq 0$. Consider $w = u - \floor{\alpha_n}u_n$. $w \in \Lambda$ and $w = \set{\alpha_n}u_n + \sum_{i=1}^{n-1} \alpha_i u_i$. So \[\dist(w, H) = \dist(\set{\alpha_n}u_n, H) = \set{\alpha_n}\dist(u_n, H)\] If $\set{\alpha_n} > 0$ then $0 < \dist(w, H) < \dist(u_n, H)$, a contradiction.

    So $\set{\alpha_n} = 0 \implies \alpha_n \in \Z$. Then $w = \sum_{i=1}^{n-1} \alpha_i u_i \implies \alpha_1, \ldots, \alpha_{n-1} \in \Z$.

    So we have constructed a basis for lattice of dimension $n$, thus finishing the proof.
\end{proof}


This is called A.N.Korkin(e)-Zolotarev(Ã¶ff) basis.

\fancyem{Exercise} Suppose $u_1, \ldots, u_n \in V$ is a basis of subspace. The integer combinations form a lattice.

\fancyem{Exercise} Suppose a $2$-dimensional lattice. Then there exists a lattice basis $u, v$ such that the angle $\alpha$ between $u, v$ satisfies $\frac{\pi}{3} \leq \alpha \leq \frac{\pi}{2}$.

\fancyem{Exercise} If $\Lambda$ is a lattice and $L$ is a lattice subspace. The orthogonal projection $\operatorname{PR}: V \to L^{\perp}$. Then $\operatorname{PR}(\Lambda) \subset L^\perp$ is a lattice.

\begin{definition}
    Suppose $u_1, \ldots, u_n$ be a basis of $\Lambda$. 
    \[\Pi=\set{\sum_{i=1}^n \alpha_i u_i: 0 \leq \alpha_i < 1, i = 1, \ldots, n}\] is the \emph{fundamental parallelepiped} of a fundamental parallelepiped of $\Lambda$.
\end{definition}
\begin{theorem}
    The volume of a fundamental parallelepiped $\Pi$ doesn't depend on $\Pi$. The volume is called the determinant of $\Lambda$. Furthermore, if $B_{r} = \set{x: \norm{x} \leq r}$, then \[\lim_{r \to \infty} = \frac{|B_r \cap \Lambda|}{\operatorname{vol}B_r} = \frac{1}{\det \Lambda}.\]
\end{theorem}
We start with a lemma:
\begin{lemma}\label{le:1.1.1}
    Let $\Pi$ be a fundamental parallelepiped of $\Lambda \subset V$. Then every vector $x \in V$ is uniquely written as $x = u + y$ where $u \in \Lambda, y \in \Pi$.
\end{lemma}
\begin{proof}
    Existence: $\Pi$ is the fundamental parallelepiped for $u_1, \ldots, u_n$. If $x = \sum_{i=1}^n \alpha_i u_i$ then $u = \sum_{i=1}^n \floor{\alpha_i} u_i$ and $y = \sum_{i=1}^n \set{\alpha_i} u_i$

    Uniqueness: suppose $x = u_1 + y_1 = u_2 + y_2$ then $u_1 - u_2 = y_2 - y_1$. Since $u_1 - u_2 \in \Lambda$ we have $y_2 - y_1 = \sum_{i=1}^n (\alpha_i - \beta_i)\mathbf{u}_i$. We have $(\alpha_i - \beta_i) \in \Z$. Since $-1 < \alpha_i - \beta_i < 1$, it has to be $0$.
\end{proof}
A geometry interpretation is that we can cover the whole space with fundamental parallelepipeds without overlaps.

\newcommand{\vol}{\operatorname{vol}}

\begin{proof}[Proof of theorem]
    Let \[X_{r} = \bigcup_{u \in B_r \cap \Lambda} (\Pi + u)\]
    Then $\operatorname{vol} X_r = |B_r \cap \Lambda| \operatorname{vol}\Pi$.

    Say, $\Pi \subset B_a$ for some $a > 0$. Then $X_r \subset B_{r + a}$.
    Look at $B_{r - a}$. It is covered by $\Pi + u: u \in \Lambda$. We should have $\norm{u} \leq r$. Hence $B_{r - a} \subset X_r$.

    So we have \[\left(\frac{r-a}{a}\right)^n = \frac{\vol B_{r-a}}{\vol B_r} \leq \frac{\vol X_r}{\vol B_r} \leq \frac{\vol B_{r+a}}{B_r} = \left(\frac{r+a}{a}\right)^n\]

    This goes to 1 when $r \to \infty$.
\end{proof}

\fancyem{Remark/Exercise} The same holds for balls not centered in the origin: \[B_{r}(x_0) = \set{x: \norm{x - x_0} \leq r}.\]

\fancyem{Exercise} Suppose a lattice $\Lambda \subset V$ and $u \in \Lambda$. The Voronoi (G.F. Voronoi, 1868-1908) region is defined by \[
\Phi_{u} = \set{x \in V: \norm{x - u} \leq \norm{x-v}, \forall v \in \Lambda}.  
\]
Show that $\Phi$ is convex (bounded by at most $2^n$ affine hyperplanes) and $\vol \Phi = \det \Lambda$.

\fancyem{Exercise} $(\det \Lambda)(\det \Lambda^*) = 1$

\section{Sublattice}
\begin{definition}
    Suppose $\Lambda \subset V$ is a lattice, and $\Lambda_0 \subset \Lambda, \Lambda_0 \subset V$ is also a lattice. $\Lambda_0$ is then called a sublattice of $\Lambda$.
\end{definition}
\begin{remark}
    We have $\rank \Lambda_0 = \rank \Lambda$.
\end{remark}
\begin{example}
    $D_n \subset \Z^n$.
\end{example}
$\Lambda$ is an Abelian group and $\Lambda_0 \subset \Lambda$ is a subgroup. Look at the quotient $\Lambda/\Lambda_0$ and cosets $\set{u + \Lambda_0}$. The index of $\Lambda_0$ in $\Lambda |\Lambda / \Lambda_0| = $ the number of cosets.

\begin{theorem}
    \begin{enumerate}
        \item Let $\Pi$ be a fundamental parallelepiped of $\Lambda_0$ Then $|\Lambda / \Lambda_0| = |\Pi \cap \Lambda|$.
        \item $|\Lambda /\Lambda_0| = \dfrac{\det \Lambda_0}{\det \Lambda}$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}
        \item By \autoref{le:1.1.1}, every coset has a unique representation in $\Pi$.
        \item Let $B_r = \set{x: \norm{x} \leq r}$. Then \[\lim_{r \to \infty} = \frac{|B_r \cap \Lambda|}{\vol B_r} = \frac{1}{\det \Lambda}.\]
        Let $S \subset \Lambda$ be the set of coset representatives. Then $|S| = |\Lambda/\Lambda_0|.$ Then $\Lambda = \bigcup_{u \in S} (u + \Lambda_0)$. Hence \[\lim_{r \to \infty} \frac{|B_r \cap (u + \Lambda_0)|}{\vol B_r} = \frac{1}{\det \Lambda_0}. \implies \frac{1}{\det \Lambda} = |S|\frac{1}{\Lambda_0}\qedhere\]
    \end{enumerate}
\end{proof}

\fancyem{Exercise} \begin{enumerate}
    \item $\det \Z^n = 1$
    \item $\det D_n = 2$.
    \item $\det D^+_n = 1$. ($n$ even)
    \item $\det A_n = \sqrt{n+1}$. $\det E_8 = 1, \det E_7 = \sqrt{2}, \det E_6 = \sqrt{3}$.
    \item If $a_1, \ldots, a_n$ are coprime integers not all $0$. \[\Lambda = \set{(x_1, \ldots, x_n) \in \Z^n: a_1x_1 + \ldots + a_nx_n = 0} \text{ has } \det \Lambda = \sqrt{a_1^2 + \ldots + a_n^2}.\] 
\end{enumerate}

\begin{corollary}
    If $u_1, \ldots, u_n \in \Lambda$ are linearly independent and \[\vol \set{\sum_{i+1}^n \alpha_iu_i: 0 \leq \alpha_i < 1} = \det \Lambda\] then $u-1, \ldots, u_n$ is a basis.
\end{corollary}
\begin{proof}
    Look at \[\Lambda_0 = \set{\sum_{i=1}^n m_iu_i: m_i \in \Z}, |\Lambda/\Lambda_0| = 1 \implies \Lambda = \Lambda_0 \qedhere\]
\end{proof}

Counting integer points. Suppose $\Lambda = \Z^n$.

Pick $n$ linearly independent vectors $u_1, \ldots, u_n \in \Lambda$. Consider \[\Pi = \set{\sum_{i=1}^n \alpha_iu_i: 0 \leq \alpha_i < 1}.\] Then \[
    |\Pi \cap \Z^n| =\ ?    
\]
Suppose $\Lambda_0 = \set{\sum_{i=1}^n m_iu_i: m_i \in \Z}$. Then $\det \Lambda_0 = \vol \Pi$.

Suppose $n = 2$, $u_1 = (3, 1), u_2 = (1, 2)$. Then $\vol \Pi = 5$. We can see that the  parallelogram contains 5 integer points.

\[
\begin{tikzpicture}
    \draw[thick, -stealth](-1,0) -> (xyz cs:x=5);
    \draw[thick, -stealth](0,-1) -> (xyz cs:y=4);
    \draw[step=1cm,gray,very thin] (0,0) grid (4, 3);
    \draw[red, thick] (0, 0) -- (1, 2);
    \draw[red, thick] (0, 0) -- (3, 1);
    \draw[red, thick, dashed] (1, 2) -- (4, 3);
    \draw[red, thick, dashed] (3, 1) -- (4, 3);
    \node[shape=circle, fill=black, scale = 0.5] () at (0, 0) {};
    \node[shape=circle, fill=black, scale = 0.5] () at (1, 1) {};
    \node[shape=circle, fill=black, scale = 0.5] () at (2, 1) {};
    \node[shape=circle, fill=black, scale = 0.5] () at (2, 2) {};
    \node[shape=circle, fill=black, scale = 0.5] () at (3, 2) {};
\end{tikzpicture}    
\]

The case for $n = 2$ is special. 
\begin{theorem}[Pick Formula (G.A. Pick, 1859-1942)]
    If $P \subset \R^2$ is a convex polygon with integer vertices and non-empty interior. Then \[
    |P \cap \Z^2| = \text{ area of } P + \frac{1}{2}|\partial P \cap \Z^2| + 1
    \]
\end{theorem}
\begin{proof}
    Left as exercise. Hint: do it for parallelograms (in any dimension) first, then do it for triangles (special case for $n = 2$), and then all polygons with integer vertices.
\end{proof}

\fancyem{Exercise} For $n = 2$, linearly independent vectors of $u, v \in \Z^2$ form a basis $\iff$ the triangle with vertices $0, u, v$ has no other integer points.

\fancyem{Exercise} For $n = 3$, construct an example of linearly independent $u, v, w \in \Z^3$ such that the tetrahedron  with vertices $0, u, v, w$ has no other integer points but $\set{u, v, w}$ is not a basis of $\Z^3$. In fact, you can have $|\Z^n/\Lambda|$ arbitrarily large.

\fancyem{Exercise} Suppose $u_1, \ldots, u_k \in \Z^n$ are linearly independent vectors and $\Lambda = \Z^n \cap \operatorname{span}(u_1, \ldots, u_k)$. The $\set{u_1, \ldots, u_k}$ is a basis of $\Lambda$ if and only if the great common divisor of all $k \times k$ minors of $\begin{bmatrix}
    u_1^T \\
    u_2^T \\
    \ldots \\
    u_k^T
\end{bmatrix}$ is $1$.

Linear algebra (Smith normal form, will not use)

If $\Lambda_0 \subset \Lambda$ is a sublattice, then there is a basis $u_1, \ldots, u_n$ of $\Lambda$ and a basis $v_1, \ldots, v_n$ of $\Lambda_0$ such that $v_i = m_iu_i$ for positive integer $m_i$ and such that $m_1$ divides $m_2$ which divides $m_3, \ldots$.

\section{Minkowski Theorem}
The goal today is to prove Minkowski Theorem (H. Minkowski, 1864-1909) for convex body.

\begin{definition}
    Suppose $V$ a Euclidean space, then a set $A \subset V$ is convex if $\forall x, y \in A, [x, y] \in A$ where $\set{[x, y] = \alpha x + (1-\alpha)y: 0 \leq \alpha \leq 1}$.
\end{definition}
\begin{definition}
    A set $A$ is symmetric if $A = -A = \{-x: x \in A\}$.
\end{definition}

\begin{theorem}
    Suppose $\Lambda \subset V$ a lattice and $A \subset V$ a convex symmetric set with $\vol A > 2^{\dim V} \det \Lambda$. Then there is $u \subset \Lambda \setminus \set{0}$ such that $u \in A$.s
\end{theorem}

\fancyem{$2^{\dim V}$ is sharp}: Pick $\Z^n \subset \R^n, \det \Z^n = 1$. Let $A = \set{-1 < x_i < 1,  i = 1, \ldots, n}$ convex and symmetric. Then $\vol A = 2^n$ and $A \cap Z^n = \set{0}$. And from geometric intuition we see that convex and symmetric is needed.

It is a result from Blichfeldt's theorem.
\begin{theorem}[H. F. Blichfeldt, 1873 - 1945]
    Let measurable $X \subset V$, $\vol X > \det \Lambda$, then there are $x, y \in X$ such that $x - y \in \Lambda \setminus \set{0}$.
\end{theorem}

\fancyem{Intuition} $\det \Lambda$ describes the volume per lattice point. Consider $\set{X + u}$ the translations of $X$ by lattice points. Some of them must overlap i.e. $(X + u_1) \cap (X + u_2) \neq \emptyset$. Then $x + u_1 = y + u_2 \implies x - y = u_2 - u_1 \in \Lambda \setminus \set{0}$.

\begin{proof}
    Choose a fundamental parallelepiped $\Pi$ of lattice $\Lambda$. Then $\det \Lambda = \vol \Pi$. Then $\{\Pi + u, u \in \Lambda\}$ cover $V$ without overlap. In particular, they cover $X$.

    Let $X_u \defeq ((\Pi + u) \cap X) - u$. $\sum_{u \in \Lambda} \vol X_u = \vol X > \vol \Pi$. And $X_u \subset \Pi$. Then $\exists u_1 \neq u_2 \st X_{u_1} \cap X_{u_2}\neq \emptyset$. Then $\exists x, y \in X \st x - u_1 = y - u_2 \implies x - y = u_1 - u_2 \in \Lambda \setminus \set{0}$.
\end{proof}

\begin{proof}[Proof of Minkowski's Theorem]
    Let $X = \frac{1}{2}A = \set{\frac{1}{2}x, x \in A}$.
    Then $\vol X = 2^{-\dim v}\vol A > \det \Lambda$. By Blichfeldt, there are $x, y \in X$ such that $x - y \in \Lambda \setminus \set{0}$. Write \[u = x - y = \frac{1}{2}(2x) + \frac{1}{2}(-2y)\]
    Since $A$ is convex and symmetric, $2x, -2y \in A$ and $x - y \in A \implies u \in A$.
\end{proof}

\fancyem{Exercise} Suppose $\Lambda \subset V$ a lattice. Let $X = \set{x \in V: \norm{x} < \norm{x - u}, \forall u \in \Lambda \setminus \set{0}}$. Let $A = 2X$. Show that $A$ is convex, symmetric, $A = 2^{\dim V} \det \Lambda$ and $ A \cap \Lambda = \{0\}$.

\begin{corollary}
    If, in addition, $A$ is compact, then it is enough to have $\vol A \geq 2^{\dim V} \det \Lambda$.
\end{corollary}
We can apply the proof for $(1 + \varepsilon)A$ and let $\varepsilon \to 0$.

\begin{corollary}
    Let $V = \R^n$, and $\norm{x}_\infty = \max_{i=1, \ldots, n} |x_i|$. Then there is a $u \in \Lambda \setminus \set{0}$ with $\norm{u}_\infty \leq (\det \Lambda)^{\frac{1}{n}}$.
\end{corollary}
Consider $A = \set{x, |x_i| \leq (\det \Lambda)^{\frac{1}{n}}}$.
\begin{corollary}
    Suppose $\Lambda \subset V$. Then there is $u \subset \Lambda \setminus \set{0}$ with $\norm{u} \leq \sqrt{\dim V}(\det \Lambda)^{\frac{1}{n}}$.
\end{corollary}

\fancyem{Exercise} If $X \subset V$ is measurable and $\vol X > m\det \Lambda$ with $m \in \Z^+$. Then there are $x_1, \ldots, x_{m+1} \in X$ such that $x_i - x_j \in \Lambda$ for all pairs $i, j$.

If $A$ is convex, symmetric, and $\vol A > m \cdot 2^{\dim V} \det \Lambda$. Then $A$ contains $m$ distinct pairs $\pm u_1, \ldots, \pm u_m$ of nonzero lattice points.

\fancyem{Exercise (Important)} If $X \subset \Lambda$ is a set such that $|X| > 2^{\dim V}$ then there are distinct $x, y \in X$ such that $\frac{x+y}{2} \in \Lambda$.

\fancyem{Exercise} Suppose $f: V \to \R_+$ is integrable and $\Lambda \subset V$ a lattice. Then there are $z_1, z_2 \in V$ such that \[\sum_{u \in \Lambda} f(u+z_1) \geq \frac{1}{\det\Lambda}\int_V f(x)\ \df x \geq \sum_{u \in \Lambda}f(u+z_2).\]


We need the column of the unit ball in $\R^n$.
\[\Gamma(x) = \int_0^\infty t^{x-1}e^{-t}\idf t\]
\[\Gamma(x+1) = x\Gamma(x)\]

\[B = \set{x: \norm{x} = 1}, B \subset \R^n, \vol B = \frac{\pi^{n/2}}{\Gamma\left(\frac{n}{2}+1\right)}\]
We start with integral:
\[\int_{-\infty}^\infty e^{-x^2}\idf x = \sqrt{\pi}, \int_{\R^n} e^{-\norm{x}^2}\idf x = \left(\sqrt{\pi}\right)^n\]
Let $S(r) = \set{x \in \R^n: \norm{x} = r}$ and $\kappa$ be the surface area of $S(1)$.
\begin{align*}
    \left(\sqrt{\pi}\right)^n & = \int_{0}^\infty \left(\int_{S(r)} e^{-\norm{x}^2} \idf x\right) \idf r \\
    & = \int_0^\infty r^n\kappa e^{-r^2}\idf r \\
    & = \frac{1}{2}\int_0^\infty t^{\frac{n-2}{2}}\kappa e^{-t}\idf t \\
    & = \kappa \frac{1}{2} \int_0^\infty t^{\frac{n-2}{2}}\kappa e^{-t}\idf t = \frac{1}{2}\kappa \gamma\left(\frac{n}{2}\right)
\end{align*}
So we have $\kappa = \frac{2\left(\sqrt{\pi}\right)^n}{\Gamma\left(\frac{n}{2}\right)}$.

Then \[
    \vol B = \int_0^1 \kappa t^{n-1} \idf r = \frac{\kappa}{n} = \frac{\pi^{n/2}}{\Gamma\left(\frac{n}{2}+1\right)}.
\]

\section{Applications of Minkowski's Theorem}
First application:
\begin{theorem}[Lagrange's four squares theorem (J-L Lagrange, 1736-1813)]
    If $n \geq 0$ is a non-negative integer, then $n = x_1^2 + x_2^2 + x_3^2 + x_4^2$ for some integer $x_1, x_2, x_3, x_4$.
\end{theorem}
\begin{proof}
    Start as Lagrange did: first, prove assuming that $n$ is prime, then there are $a, b \in \Z$ such that $a^2 + b^2 + 1 \equiv 0 \pmod{n}$.

    $n = 2$ is clear. Consider values of $a^2 \pmod{n}$ for $n > 2$ and $a = 0, 1, \ldots, \frac{n-1}{2}$. They are all distinct. Otherwise $a_1^2 \equiv a_2^2 \equiv \pmod{n} \implies (a_1 - a_2)(a_1 + a_2) \pmod{n}$.

    Consider values $-1-b^2 \pmod{n}$ for $b = 0, 1, \ldots, \frac{n-1}{2}$. They are all different values.

    There are a total of $n+1$ values, so there exists $a^2 \equiv -1 - b^2 \pmod{n}$ by pigeonhole principle.

    We introduce one generally useful lemma:
    \begin{lemma}
        Suppose $a_1, \ldots, a_k \in \Z^n$ and $m_1, \ldots, m_k$ positive integers and
        \[\Lambda = \set{x \in \Z^n: \inner{x}{a_i} \equiv 0 \pmod{m_i}}.\]
        Then $\Lambda$ is a lattice and $\det \Lambda \leq m_1\cdots m_k$.
    \end{lemma}
    Consider their cosets: pick $0 \leq b_i \leq m_i$, and the coset is \[\set{x \in \Z^n: \inner{x}{a_i} \equiv b_i \pmod{m_i}}\] if the set is non-empty. Then $|\Z^n / \Lambda| = \frac{\det\Lambda}{\det \Z^n}$.

    The rest is from Davenport:
    Suppose a lattice \[\Lambda = \set{x \in \Z^4: \begin{array}{c} x_1 \equiv ax_3 + bx_4 \\ x_2 \equiv ax_4 - bx_3\end{array} \pmod{n}}.\]
    If $(x_1, x_2, x_3, x_4) \in \Lambda$ then \begin{align*}
        x_1^2 + x_2^2 + x_3^2 + x_4^2 \equiv (ax_3 + bx_4)^2 + (ax_4 - bx_3)^2 + x_3^2 + x_4^2 \pmod{n} \\
        a^2x_3^2 + b^2x_4^2 + 2abx_3x_4 + \\
        a^2x_4^2 + b^2x_3^2 - 2abx_3x_4 + x_3^2 + x_4^2 \equiv (a^2 + b^2 + 1)x_3^2 + (b^2 + a^2 + 1) x_4^2 \equiv 0 \pmod{n}
    \end{align*}

    So we have $x_1^2 + x_2^2 + x_3^2 + x_4^2 \equiv 0 \pmod{n}$ for all $(x_1, x_2, x_3, x_4) \in \Lambda$. So $\det \Lambda \leq n^2$. Consider the ball $B$ with radius $\sqrt{2n}$. The volume of the ball $\vol B = 2n^2\pi^2 \geq 2^4 n^2 \geq 2^4 \det \Pi$. So there exists $(x_1, x_2, x_3, x_4) \in \Lambda \setminus \set{0}$ such that $x_1^2 + x_2^2 + x_3^2 + x_4^2 < 2n$ and $x_1^2 + x_2^2 + x_3^2 + x_4^2 \equiv 0 \pmod{n}$.

    So we conclude that such $x_1^2 + x_2^2 + x_3^2 + x_4^2 = n$.

    Now suppose $n$ is not prime, write $n = \prod p_i$ where $p_i$'s are prime numbers. \[(x_1^2 + x_2^2 + x_3^2 + x_4^2)(y_1^2 + y_2^2 + y_3^2 + y_4^2) = z_1^2 + z_2^2 + z_3^2 + z_4^2\] where \[\begin{cases}
        z_1 = x_1y_1 - x_2y_2 - x_3y_3 - x_4y_4 \\
        z_2 = x_1y_2 + x_2y_1 + x_3y_4 - x_4y_3 \\
        z_3 = x_1y_3 + x_2y_4 + x_3y_1 + x_4y_2 \\
        z_4 = x_1y_4 - x_2y_3 - x_3y_3 + x_4y_1 \\
    \end{cases}\]

    Remember through quaternions. $x_1 + ix_2 + jx_3 + kx_4$.
\end{proof}

Jacobi's Formula (C.G.J Jacobi, 1804-1851)
The number of integer solutions (not necessarily positive) of the equation \[x_1^2 + x_2^2 + x_3^2 + x_4^2 = n\] is $8 \cdot \sum_{d | n, 4 \not| d} d$.

\fancyem{Exercise} Deduce the Jacobi's Formula from the identity \[
  \left(\sum_{k=-\infty}^\infty q^k\right)^4 = 1 + 8\sum_{k=1}^\infty \frac{q^k}{\left(1 + (-q)^k\right)^2}, \text{ for } |q| < 1.
\]

Gauss Circle Problem (C.-F Gauss, 1777, 1855)
$B_r = \set{x \in \R^2: \norm{x} \leq r}$. As $r \to \infty$, $|B(r) \cap \Z^2| \approx \pi r^2 + O(r^{1/2 + \varepsilon})$ for any $\varepsilon > 0$? Best known is $O(r^{0.63})$ for $\varepsilon = 0.13$.

\fancyem{Exercise} If $n$ is prime, $n \equiv 1 \pmod{4}$. Then $n = x_1^2 + x_2^2$ for some $x_1, x_2 \in \Z$.

How well can we approximate a real number for rational numbers?

If $\alpha \in \R$ and $q \geq 1$ is an integer, then for some integer $p$ we have $\left|\alpha - \frac{p}{q}\right| \leq \frac{1}{2q}$.

\begin{theorem}
    For any $\alpha \in \R$ and $M > 0$, there exists $q \geq M$ and an integer $p$ such that $\left|\alpha - \frac{p}{q}\right| \leq \frac{1}{q^2}$.
\end{theorem}
In fact, we can have $\left|\alpha - \frac{p}{q}\right| \leq \frac{1}{q^2\sqrt{5}}$, which is optimal.

It shows that this holds for infinitely many $q$.

\begin{proof}
    Assume WLOG that $\alpha$ is irrational. Pick $Q \geq 1$ an integer. Consider the parallelogram in $\R^2: \set{|x|\leq Q, |\alpha x - y| \leq \frac{1}{Q}}$.
    \[
    \begin{tikzpicture}
        \draw[thick, -stealth](-5,0) -> (xyz cs:x=5);
        \draw[thick, -stealth](0,-3) -> (xyz cs:y=3);
        \draw[red, dashed] (-4, -2) -- (4, 2);
        \draw[red] (-4, -1) -- (4, 3);
        \draw[red] (-4, -3) -- (4, 1);
        \draw[red] (-4, -3) -- (-4, -1);
        \draw[red] (4, 3) -- (4, 1);
        \draw[red, dashed] (4, 0) -- (4, 1);
        \draw[red, dashed] (-4, 0) -- (-4, -1);
        \node[shape=rectangle, fill=black, scale = 0.5] (A) at (4, 0) {};
        \node[below] at (A.south) {$Q$};
        \node[shape=rectangle, fill=black, scale = 0.5] (B) at (-4, 0) {};
        \node[below] at (B.south) {$-Q$};
        \draw[decorate, thick, decoration = {brace, raise=3pt}] (4,3) -- (4,2)
        node[pos=0.5,right=3pt,black]{$\frac{1}{Q}$};
    \end{tikzpicture}
    \]

    $\Pi$ is convex, symmetric, compact, with area $\Pi = 4 = 2^2$.

    By Minkowski, there exists $(q, p) \in \Z^2 \setminus \set{0}, (q, p) \in \Pi$ such that $\left|\alpha q - p\right| \leq \frac{1}{Q}, |p| \leq \frac{1}{Q} \implies p = 0$. Assume that $q > 0$. 

    We have $q \leq Q$, and \[
    \left|\alpha q - p\right| \leq \frac{1}{Q} \implies \left|\alpha - \frac{p}{q}\right| \leq \frac{1}{Qq} \leq \frac{1}{q^2}
    \]
    It remains to show that for any $M$ we can choose $q \geq M$.

    Why? $\alpha$ is irrational. Choose $Q$ so large that we cannot have $\left|\alpha - \frac{p}{q}\right| \leq \frac{1}{Q}$ for $q \leq M$.
\end{proof}

\fancyem{Exercise} For any $\alpha_1, \ldots, \alpha_n \in \R$ and any $M$, there are integers $p_1, \ldots, p_n$ and $q \geq M $ such that $\left|\alpha_k - \frac{p_k}{q}\right| \leq \frac{1}{q^{\frac{n+1}{n}}}$ for $k = 1, \ldots, n$.

Continued fractions: given $\alpha$, we produce a possibly infinite expression: \[
    \alpha = a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \frac{1}{\vdots}}}\]
and denote $\alpha = [a_0; a_1, a_2, \ldots]$
How: introduce variables $\beta_0, \beta_1 \ldots$ where $\beta_0 = \alpha$. Write $\beta_0 = \floor{\beta_0} + \set{\beta_0}$.

Let $a_0 = \floor{\beta_0}$, if $\set{\beta_0} = 0$ then stop. Otherwise let $\beta_1 = \frac{1}{\set{\beta_0}}$. Let $\alpha_1 = \floor{\beta_1}$, continue.

\begin{example}
    Let $\alpha = \sqrt{2}$. $\beta_0 = \sqrt{2}$ and $a_0 = 1$.
    \[\sqrt{2} = 1 + (\sqrt{2} - 1) = 1 + \frac{1}{\frac{1}{\sqrt{2}-1}} = 1 + \frac{1}{\sqrt{2} + 1}\]
    \[ = 1 + \frac{1}{2 + (\sqrt{2} - 1)} = 1 + \frac{1}{2 + \frac{1}{\frac{1}{\sqrt{2} - 1}}}\]
\end{example}

Convergents:
k-th convergent: \[[a_0;a_1, \ldots, a_k] = a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \frac{1}{\ldots + \frac{1}{a_k}}}} = \frac{p_k}{q_k}\]

\fancyem{Exercises} Suppose $p_k, q_k$ are coprime. Prove that $p_k = a_kp_{k-1} + p_{k-2}, q_k = a_kq_{k-1}+q_{k-2}$ for $k \geq 2$.
Hint: Induction $[a_0; a_1, \ldots, a_k] \to [a_1; a_2, \ldots, a_k]$.

Prove that $p_{k-1}q_k - p_kq_{k-1} = (-1)^k$ for $k \geq 1$.

Prove that $q_kq_{k-2} - p_kq_{k-2} = (-1)^{k-1} a_k$ for $k \geq 2$.

\[\begin{tikzpicture}
    \draw[thick, -stealth](-3,0) -> (xyz cs:x=3);
    \node[shape=rectangle, fill=black, scale = 0.3] (A1) at (0, 0) {};
        \node[below] at (A1.south) {$\alpha$};
    \node[shape=rectangle, fill=black, scale = 0.3] (A2) at (-2, 0) {};
        \node[below] at (A2.south) {$\dfrac{p_k}{q_k}, k$ even};
    \node[shape=rectangle, fill=black, scale = 0.3] (A3) at (2, 0) {};
        \node[below] at (A3.south) {$\dfrac{p_k}{q_k}, k$ odd};
    \draw[-stealth, thick] (A3) to [out=135,in=45,looseness=1.1] (A1) node[midway, above, sloped] {};
    \draw[-stealth, thick] (A2) to [out=45,in=135,looseness=1.1] (A1) node[midway, above, sloped] {};
\end{tikzpicture}\]

Prove that $\left|\alpha - \frac{p_k}{q_k}\right| \leq \frac{1}{q_kq_{k+1}}, k \geq 0$.

(Hard, easy if replace 5 by 2) Prove that at least one of the three holds:
\[\left|\alpha - \frac{p_k}{q_k}\right| \leq \frac{1}{q_k^2 \sqrt{5}}, \left|\alpha - \frac{p_{k-1}}{q_{k-1}}\right| \leq \frac{1}{q_{k-1}^2 \sqrt{5}}, \text{ or } \left|\alpha - \frac{p_{k-2}}{q_{k-2}}\right| \leq \frac{1}{q_{k-2}^2 \sqrt{5}}.\]

Convergents are the best rational approximation in the following sense:

Given $\alpha$ and integer $Q > 1$, we want to find $\frac{a}{b}$ such that $|b| \leq Q$ and $|\alpha b - a|$ is the smallest possible.

\fancyem{Claim} Must have $\frac{a}{b} = \frac{p_k}{q_k}$. (With possible exception of $k = 0, 1$.)

\fancyem{Why/Exercises} Suppose not: pick the largest $k$ such that $\frac{a}{b}$ is between $\frac{p_{k-1}}{q_{k-1}}$ and $\frac{p_k}{q_k}$.
\[\begin{tikzpicture}
    \draw[thick, -stealth](-3,0) -> (xyz cs:x=3);
    \node[shape=rectangle, fill=black, scale = 0.3] (A) at (0, 0) {};
        \node[below] at (A.south) {$\alpha$};
    \node[shape=rectangle, fill=black, scale = 0.3] (A2) at (-2, 0) {};
        \node[below] at (A2.south) {$\frac{p_k}{q_k}$};
    \node[shape=rectangle, fill=black, scale = 0.3] (A3) at (2.5, 0) {};
        \node[below] at (A3.south) {$\frac{p_{k-1}}{q_{k-1}}$};
    \node[shape=rectangle, fill=black, scale = 0.3] (A4) at (1.5, 0) {};
        \node[below] at (A4.south) {$\frac{p_{k+1}}{q_{k+1}}$};
\end{tikzpicture}\]
Then $\left|\frac{a}{b}-\frac{p_{k-1}}{q_{k-1}}\right| \geq \frac{1}{bq_{k-1}}$, easy.
Then $\abs{\frac{a}{b} - \frac{p_{k-1}}{q_{k-1}}} \leq \abs{\frac{p_k}{q_k}-\frac{p_{k-1}}{q_{k-1}}} = \frac{1}{q_kq_{k-1}}$ from last exercise. 

On the other hand $\abs{\alpha - \frac{a}{b}}\geq\abs{\frac{p_{k+1}}{q_{k+1}}-\frac{a}{b}} \geq \frac{1}{bq_{k+1}}$. So $\abs{\alpha b - a} \geq \frac{1}{q_{k+1}}$ but $\abs{\alpha q_k - p_k}\leq\frac{1}{q_{k+1}}$. 

So $b > q_k$.

\begin{theorem}[Liouville's theorem (Joseph Liouville, 1809-1882)]
    If $\alpha$ is an algebraic irrational of degree $n \geq 2$. Then $\abs{\alpha - \frac{p}{q}} \geq \frac{c(\alpha)}{q^n}$ with $c(\alpha) > 0$.
\end{theorem}
Corollary: $\alpha = \sum_{n=1}^\infty \frac{1}{10^{n!}}$ is transcendental. (the rough idea is that if an irrational number is approximated too well then it is transcendental)


\section{Sphere Packing}
Denote balls: $B_r(x_0) \defeq \set{x: \norm{x - x_0} \leq r}$.

\begin{definition}
    \emph{A sphere packing} is a (usually infinite) collection of balls $B_r(x_i)$ with the same radius with pairwise non-intersecting interiors.
    
    The \emph{density} of a sphere packing $\sigma$ is defined as \[
        \sigma = \limsup_{R\to\infty} \frac{\vol\left(B_R(0) \cap \bigcup_i B_r(x_i)\right)}{\vol B_R(0)}\]
\end{definition}

Generally we want to find the largest density of a sphere packing in $\R^n$. We know $n=1, 2, 3, 8, 24$.

If centers $x_i$ forms a lattice, then it is called a lattice (sphere) packing. For densest lattice packings, we know $n = 1, 2, 3, 4, 5, 6, 7, 8, $ and $24$.

\fancyem{Remark/Easy Exercise} If $\set{x_i}$ forms a lattice $\Lambda \subset \R^n$, $\sigma(\Lambda) = \frac{\pi^{n/2}}{\Gamma\left(\frac{n}{2}+1\right)}\frac{\rho^n}{\det \Lambda}$ where $\rho$ is called the packing radius, which is defined by $\rho(\Lambda) = \frac{1}{2}\min_{x \in \Lambda \setminus \set{0}} \norm{x}$. If $\Lambda_1 \sim \Lambda_2$ then $\sigma(\Lambda_1) = \sigma(\Lambda_2)$.

For $n=1, \sigma(\Lambda) = 1$.

For $n=2, \rho(\Z^2) = \frac{1}{2}, \det \Z^2 = 1, \sigma(\Z^2) = \frac{\pi}{4}$.
$\rho(A_2) = \frac{\sqrt{2}}{2}, \det A_2 = \sqrt{3}, \sigma(A_3) = \pi \frac{1}{2\sqrt{3}}$. (locally denest) (Best lattice packing by Gauss, best packing overall by Laselo Fejes Toth (1915-2005))

For $n = 3, \Lambda = A_3 = D_3, \rho(\Lambda) = \frac{\sqrt{2}}{2}, \det \Lambda = 2, \sigma(\Lambda) = \frac{4\pi}{3}\frac{1}{4\sqrt{2}} = \frac{\pi}{3\sqrt{2}}$. (not locally denest) (Best lattice packing by Gauss, best packing overall by T.Hales (1958- ))

There is a continuum of non-equivalent non-lattice densest packings.

\end{document}