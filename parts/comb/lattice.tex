\documentclass{report}
\usepackage{amsmath,amssymb,amsthm,textcomp,gensymb,nccmath}
\usepackage{mathtools}
\renewcommand{\qedsymbol}{$\blacksquare$}

\setlength{\topmargin}{0.5in}
\usepackage[margin=4cm]{geometry}
\usepackage{enumerate}

\usepackage{setspace}
\onehalfspacing
\usepackage{parskip}
\setlength{\parskip}{0.5em}
\usepackage[T1]{fontenc}
\usepackage{palatino}

% useful characters/operators
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\matP}{\mathbb{P}}
\newcommand{\matE}{\mathbb{E}}
\newcommand{\matS}{\mathbb{S}}
\newcommand{\matH}{\mathbb{H}}
\newcommand{\matT}{\mathbb{T}}
\newcommand{\st}{\ s.t.\ }
\newcommand{\ie}{\ i.e.\ }
\newcommand{\eg}{\ e.g.\ }
\def \diam {\operatorname{diam}}
\def \Hom {\operatorname{Hom}}
\def \id {\operatorname{id}}
\def \tr {\operatorname{tr}}
\def \rk {\operatorname{rk}}
\def \sp {\operatorname{span}}
\def \dist {\operatorname{dist}}
\def \intr {\operatorname{int}}
\def \sgn {\operatorname{sgn}}
\def \im {\operatorname{Im}}
\def \re {\operatorname{Re}}
\def \curl {\operatorname{curl}}
\def \divg {\operatorname{div}}
\def \GL {\operatorname{GL}}
\def \Aut {\operatorname{Aut}}
\def \per {\operatorname{per}}
\def \LE {\operatorname{LE}}
\def \indeg {\operatorname{indeg}}
\def \outdeg {\operatorname{outdeg}}
\def \Par {\operatorname{Par}}
\def \Gr {\operatorname{Gr}}
\def \del {\operatorname{del}}
\def \add {\operatorname{add}}
\def \Gal {\operatorname{Gal}}
\def \Sym {\operatorname{Sym}}
\def \dist {\operatorname{dist}}
\newcommand{\pdr}[2]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\df}{\mathrm{d}}
\newcommand{\dr}[2]{\dfrac{\df #1}{\df #2}}
\newcommand{\inner}[2]{\left\langle #1, #2\right\rangle}
\newcommand{\qbin}[2]{\begin{bmatrix}{#1}\\ {#2}\end{bmatrix}_q}
\newcommand{\into}{\hookrightarrow}
\newcommand{\onto}{\twoheadrightarrow}
\newcommand{\from}{\leftarrow}
\newcommand{\norm}[1]{\left\| #1 \right\|}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\set}[1]{\left\{ #1 \right\}}


% arrows and :=, =:
\makeatletter
\providecommand*{\twoheadrightarrowfill@}{%
  \arrowfill@\relbar\relbar\twoheadrightarrow
}
\providecommand*{\twoheadleftarrowfill@}{%
  \arrowfill@\twoheadleftarrow\relbar\relbar
}
\providecommand*{\xtwoheadrightarrow}[2][]{%
  \ext@arrow 0579\twoheadrightarrowfill@{#1}{#2}%
}
\providecommand*{\xtwoheadleftarrow}[2][]{%
  \ext@arrow 5097\twoheadleftarrowfill@{#1}{#2}%
}
\makeatother

\newcommand{\defeq}{\vcentcolon=}
\newcommand{\eqdef}{=\mathrel{\mathop:}}

% integral for measure theory
\newcommand{\lowerint}{\underline{\int_{\R^d}}}
\newcommand{\upperint}{\overline{\int_{\R^d}}}
\newcommand{\lint}[1]{\underline{\int_{\R^d}} #1 (x)dx}
\newcommand{\uint}[1]{\overline{\int_{\R^d}} #1 (x)dx}
\newcommand{\sint}[1]{\simp{\int_{\R^d} #1 (x)dx}}
\newcommand{\lesint}[1]{\int_{\R^d} #1 (x)dx}

% note taking
\newcommand{\fancyem}[1]{\underline{\textsc{#1}}}

% theorem style
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{conjecture}{Conjecture}[section]
\newtheorem{proposition}{Proposition}[section]

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}

% pseudocode and algorithms
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{algorithmicx}
\counterwithin{algorithm}{section}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% for clearer reference
\usepackage{hyperref}
\newcommand{\corollaryautorefname}{Corollary}
\newcommand{\lemmaautorefname}{Lemma}
\newcommand{\definitionautorefname}{Definition}
\newcommand{\exampleautorefname}{Example}
\newcommand{\conjectureautorefname}{Conjecture}
\renewcommand{\subsectionautorefname}{Section}
\newcommand{\algorithmautorefname}{Algorithm}

% other styling
\usepackage{fancyvrb, fancyhdr}
\usepackage{tikz-cd}
\usepackage{tikz}
\PassOptionsToPackage{usenames, x11names}{xcolor}
\usepackage{tcolorbox}
\selectcolormodel{cmy}

\newcommand{\edge}{
    \begin{tikzcd}[cramped, sep=small, labels={font=\everymath\expandafter{\the\everymath\textstyle}}]
        u \arrow[r, "e", no head] & v
    \end{tikzcd}
}


\pagestyle{fancy}
\fancyhead[LO,L]{\leftmark}
\fancyhead[RO,R]{Yiwei Fu}
\fancyfoot[CO,C]{\thepage}
\renewcommand{\sectionmark}[1]{\markboth{#1}{#1}}

\numberwithin{equation}{section}

\newcommand{\fnl}{\parbox[t]{0\linewidth}{}}
\newcommand*\ttlmath[2]{\texorpdfstring{$\boldsymbol{#1}$}{#2}}

\usepackage{epigraph}

% \epigraphsize{\small}% Default
\setlength\epigraphwidth{8cm}
\setlength\epigraphrule{0pt}

\usepackage{etoolbox}

\makeatletter
\patchcmd{\epigraph}{\@epitext{#1}}{\itshape\@epitext{#1}}{}{}
\makeatother

% combinatorics special
\usepackage{pgfopts}
\usepackage{ytableau}



\begin{document}
\title{Notes for Math 669}
\author{Yiwei Fu, Instructor: Alexander Barvinok}
\date{FA 2022}
\maketitle


\tableofcontents
Office hours: 

\clearpage
\pagenumbering{arabic}


\chapter{}

\section{Lattice and Its Basis}
\begin{definition}
    A lattice $\Lambda \subset V$ is a discrete additive group.
\end{definition}

Last time: $L \in V$ is a subspace if $L = \operatorname{span} (L \cap \Lambda)$

\begin{theorem}
    If $L$ is a lattice subspace, $L \neq V$, then $\exists u \in L \setminus \Lambda$ such that $d(u, L) \leq d(x, L)$ for all $x \in L \setminus \Lambda$.
\end{theorem}

Say $L \in \operatorname{span}\left\{u_1, \ldots, u_m\right\}$ linearly independent vectors, $\Pi = \left\{\right\}$ There is $u \in \Lambda \setminus L$ such that $\dist(u, \Pi) \leq \dist(x, \Pi)$ for all $x \in \Lambda \setminus L$. 
\begin{proof}
    Take $\rho > 0$ large enough. Consider $\Pi_\rho = \left\{y, d(y, \Pi) \leq \rho\right\}$. It contains points from $\Lambda \setminus L$, choose the one in $\Pi_\rho \cap (\Lambda \setminus L)$ closet to $\Pi$.
\end{proof}
\fancyem{Claim} $u \in \Lambda \setminus L$ is what we need. Why?
Pick any $x \in \Lambda \setminus L$. Let $y \in L$ be the closest to $x$. 
\[\dist(x, L) = \norm{x - y} = \norm{(x - w) - (y - w)}.\]
\[y = \sum_{i=1}^m d_iu_i\]
Let $w = \sum_{i=1}^m \floor{\alpha_i}u_i \in \Lambda \setminus L, y - w = \sum_{i=1}^m \set{\alpha_i}u_i \in \Pi$. 

\begin{theorem}
    Every lattice has a basis.
\end{theorem}
\begin{proof}
    By induction on $n = \dim V$.
    
    \textbf{Base case:} for $n = 1$, we have $V = \R$.

    Let $u > 0$ be the lattice vector closet to $0$, among all positive vectors in $\Lambda$.

    Then $u$ is a basis of $\Lambda$. Pick any $v \in \Lambda$. Assume $v > 0$ WLOG. Then $v = \alpha u$ for $\alpha > 0$. If $\alpha \in \Z$ then we are done. If not, consider $w = \alpha u - \floor{\alpha} u = \set{\alpha} u$, this is closer to $0$ than $u$, a contradiction.

    \textbf{Induction hypothesis:} suppose any lattice of dimension $n - 1$ has a basis.

    \textbf{Induction step:} pick a lattice hyperplane $H$ (lattice subspace with $\dim = n - 1$). Then $\Lambda_1 = H \cap \Lambda$ has a basis $u_1, \ldots, u_{n-1}$. Pick $u_n$ such that $u_n \notin H$ and $\dist(u_n, H)$ is the smallest. We claim that $u_1, \ldots, u_{n-1}, u_n$ is a basis of $\Lambda$.

    Let $u \in \Lambda$, $u = \sum_{i=1}^n \alpha_i u_i$ with $\alpha_i \in \R$. If $\alpha_n = 0$ then $u \in \Lambda_1$, then $\alpha_1, \ldots, \alpha_{n-1} \in \Z$. Suppose $\alpha_n \neq 0$. Consider $w = u - \floor{\alpha_n}u_n$. $w \in \Lambda$ and $w = \set{\alpha_n}u_n + \sum_{i=1}^{n-1} \alpha_i u_i$. So \[\dist(w, H) = \dist(\set{\alpha_n}u_n, H) = \set{\alpha_n}\dist(u_n, H)\] If $\set{\alpha_n} > 0$ then $0 < \dist(w, H) < \dist(u_n, H)$, a contradiction.

    So $\set{\alpha_n} = 0 \implies \alpha_n \in \Z$. Then $w = \sum_{i=1}^{n-1} \alpha_i u_i \implies \alpha_1, \ldots, \alpha_{n-1} \in \Z$.

    So we have constructed a basis for lattice of dimension $n$, thus finishing the proof.
\end{proof}


This is called A.N.Korkin(e)-Zolotarev(Ã¶ff) basis.

\fancyem{Exercise} Suppose $u_1, \ldots, u_n \in V$ is a basis of subspace. The integer combinations form a lattice.

\fancyem{Exercise} Suppose a $2$-dimensional lattice. Then there exists a lattice basis $u, v$ such that the angle $\alpha$ between $u, v$ satisfies $\frac{\pi}{3} \leq \alpha \leq \frac{\pi}{2}$.

\fancyem{Exercise} If $\Lambda$ is a lattice and $L$ is a lattice subspace. The orthogonal projection $\operatorname{PR}: V \to L^{\perp}$. Then $\operatorname{PR}(\Lambda) \subset L^\perp$ is a lattice.

\begin{definition}
    Suppose $u_1, \ldots, u_n$ be a basis of $\Lambda$. 
    \[\Pi=\set{\sum_{i=1}^n \alpha_i u_i: 0 \leq \alpha_i < 1, i = 1, \ldots, n}\] is the \emph{fundamental parallelepiped} of a fundamental parallelepiped of $\Lambda$.
\end{definition}
\begin{theorem}
    The volume of a fundamental parallelepiped $\Pi$ doesn't depend on $\Pi$. The volume is called the determinant of $\Lambda$. Furthermore, if $B_{\tau} = \set{x: \norm{x} \leq \tau}$, then \[\lim_{\tau \to \infty} = \frac{|B_\tau \cap \Lambda|}{\operatorname{vol}B_\tau} = \frac{1}{\det \Lambda}.\]
\end{theorem}
We start with a lemma:
\begin{lemma}
    Let $\Pi$ be a fundamental parallelepiped of $\Lambda \subset V$. Then every vector $x \in V$ is uniquely written as $x = u + y$ where $u \in \Lambda, y \in \Pi$.
\end{lemma}
\begin{proof}
    Existence: $\Pi$ is the fundamental parallelepiped for $u_1, \ldots, u_n$. If $x = \sum_{i=1}^n \alpha_i u_i$ then $u = \sum_{i=1}^n \floor{\alpha_i} u_i$ and $y = \sum_{i=1}^n \set{\alpha_i} u_i$

    Uniqueness: suppose $x = u_1 + y_1 = u_2 + y_2$ then $u_1 - u_2 = y_2 - y_1$. Since $u_1 - u_2 \in \Lambda$ we have $y_2 - y_1 = \sum_{i=1}^n (\alpha_i - \beta_i)\mathbf{u}_i$. We have $(\alpha_i - \beta_i) \in \Z$. Since $-1 < \alpha_i - \beta_i < 1$, it has to be $0$.
\end{proof}
A geometry interpretation is that we can cover the whole space with fundamental parallelepipeds without overlaps.


\end{document}